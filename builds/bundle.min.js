"use strict";function App(){this.init()}function Filter(e){e&&(this.filterForm=e,this.tabletLabel=document.querySelector(".filterTablet"),this.desktopSelects=document.querySelector(".desktopSelects"),this.selectItems=document.querySelectorAll(".selectItem"),this.options=this.filterForm.querySelectorAll("option"),this.tabletLabel.addEventListener("click",this.openFilter.bind(this)),this.ww=window.innerWidth,this.ww>1024?this.desktopToggle():this.mobileSelectedOptions())}function OfferBanner(e){e&&(this.offer=e,this.itemImg=document.querySelectorAll(".arrivalItem")[0],this.itemImg.style.cssText="margin-bottom:"+(this.offer.clientHeight+this.offer.clientHeight/4)+"px;")}function GoToItem(e){e&&(this.items=e,this.items.addEventListener("click",this.goToDetailItem.bind(this)))}function Bag(e){e&&(this.buttonAdd=e,this.cart=localStorage.cart?JSON.parse(localStorage.cart):{},this.buttonAdd.addEventListener("click",this.addGoose.bind(this)))}function Thumbnail(e){e&&(this.thumbnailBlock=e,this.fullImg=document.querySelector(".fullItem").querySelector("img"),this.thumbnailBlock.addEventListener("click",this.doFullImg.bind(this)))}function ProductOptions(e){e&&(this.options=document.querySelector(".rowOptionsProduct "),this.options.addEventListener("click",this.addClassToOption.bind(this)))}function Search(){this.searchButton=document.querySelector(".searchButton"),this.searchButton.addEventListener("click",this.openSearch.bind(this))}function Menu(){this.hamburger=document.querySelector(".mobileMenu"),this.nav=document.querySelector(".nav"),this.hamburger.addEventListener("click",this.openMenu.bind(this))}function Shop(e){if(e){this.shop=e,this.buttonBuy=document.querySelector(".buyNow"),this.totalCost=document.querySelector(".totalCost"),this.emptyBag=document.querySelector(".emptyBag"),this.cart=localStorage.cart?JSON.parse(localStorage.cart):{},this.checkEmpty();var t="";this.buttonBuy.addEventListener("click",this.buyGoose.bind(this)),this.emptyBag.addEventListener("click",this.clearBag.bind(this,"")),this.totalSum();for(var o in this.cart)t=this.createItem(this.cart[o],o),document.querySelector(".shopItems").insertAdjacentHTML("beforeEnd",t);this.removeButton=document.querySelectorAll(".removeItem");for(var r=0;r<this.removeButton.length;r++)this.removeButton[r].addEventListener("click",this.removeItem.bind(this))}}function Slider(e,t,o){if(e&&(this.slider=e,this.sliderWidth=this.slider.clientWidth,this.items=document.querySelectorAll(".sliderItem"),this.controls=document.querySelector(".controls"),this.ul=document.querySelector(".sliderList"),this.ulWidth=this.ul.firstElementChild.clientWidth*this.items.length,this.ul.style.cssText="width:"+this.ulWidth+"px",this.generatePoints(this.items.length),this.controls.addEventListener("click",this.moveSliderOnClick.bind(this)),this.currentSlide=0,t||!0===t)){var r=o||4e3;this.autoSlider(r),this.slider.addEventListener("mouseenter",this.clearInterval.bind(this)),this.slider.addEventListener("mouseleave",this.autoSlider.bind(this,r))}}document.addEventListener("DOMContentLoaded",function(){new App}),App.prototype.init=function(){this.polyfillClosest(),new Search,new Menu,new OfferBanner(document.querySelector(".extraOff")),new Filter(document.querySelector(".formFilter")),new ProductOptions(document.querySelector(".listOptions")),new Thumbnail(document.querySelector(".tumbs")),new Bag(document.querySelector(".addToBag")),new GoToItem(document.querySelector(".rowArrivals")),window.localStorage&&window.sessionStorage&&this.storage(),new Shop(document.querySelector(".shoppingBag")),new Slider(document.querySelector(".slider"),!1,5e3)},App.prototype.storage=function(){return this.localStorageCommonPrice=localStorage.commonPrice?localStorage.commonPrice:"",this.localStorageCountItems=localStorage.countItems?localStorage.countItems:"",document.querySelector(".commonPrice").innerHTML="£"+this.localStorageCommonPrice+'<span class="countItems">('+this.localStorageCountItems+")</span>",[this.localStorageCommonPrice,this.localStorageCountItems]},App.prototype.polyfillClosest=function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}})},Search.prototype=Object.create(App.prototype),Menu.prototype=Object.create(App.prototype),OfferBanner.prototype=Object.create(App.prototype),Filter.prototype=Object.create(App.prototype),ProductOptions.prototype=Object.create(App.prototype),Thumbnail.prototype=Object.create(App.prototype),Bag.prototype=Object.create(App.prototype),GoToItem.prototype=Object.create(App.prototype),Shop.prototype=Object.create(App.prototype),Slider.prototype=Object.create(App.prototype),window.addEventListener("resize",function(e){new OfferBanner(document.querySelector(".extraOff")),new Slider(document.querySelector(".slider"),!0,5e3)}),Filter.prototype.openFilter=function(){this.desktopSelects.classList.toggle("mobileSelects")},Filter.prototype.openSelect=function(e){var t=e&&e.target||e.srcElement;if("selectLabel"==t.parentNode.getAttribute("class")){t=t.parentNode.parentNode;for(var o=0;o<this.selectItems.length;o++)this.selectItems[o]!=t&&this.selectItems[o].querySelector("select").classList.remove("display");t.querySelector("select").classList.toggle("display");var r=t.querySelector("select").children.length;t.querySelector("select").setAttribute("size",r)}},Filter.prototype.desktopToggle=function(){this.desktopSelects.addEventListener("click",this.openSelect.bind(this));for(var e=0;e<this.options.length;e++)this.options[e].closest("select").addEventListener("click",this.closeSelect.bind(this))},Filter.prototype.closeSelect=function(e){var t=e&&e.target||e.srcElement;return this.valueFilter=t.closest(".selectItem").querySelector(".valueFilter"),this.nameFilter=t.closest(".selectItem").querySelector(".nameFilter"),t.closest("select").classList.remove("display"),t="SELECT"==t.tagName?t(t.options.selectedIndex):t,"notSelected"===t.value?this.filterStyles("remove","",t):this.filterStyles("add",t.innerText,t)},Filter.prototype.filterStyles=function(e,t,o){console.log(t,o);var r=document.querySelector(".desktopSelects").firstElementChild,i=document.querySelector(".desktopSelects").lastElementChild;o.closest(".selectItem").classList[e]("selectedItem"),this.nameFilter.classList[e]("nameFilterSmall"),this.valueFilter.innerHTML=t,o.closest(".selectItem")===r&&document.querySelector(".filter").classList[e]("firstSelected"),o.closest(".selectItem")===i&&document.querySelector(".filter").classList[e]("lastSelected")},Filter.prototype.mobileSelectedOptions=function(){this.filterTablet=document.querySelector(".filterTablet");for(var e=0;e<this.selectItems.length;e++)this.selectItems[e].querySelector("select").children[0].setAttribute("selected","selected"),this.filterTablet.innerHTML+=this.selectItems[e].querySelector("select").children[0].innerHTML+","},GoToItem.prototype.goToDetailItem=function(e){var t=e&&e.target||e.srcElement,o=t.closest(".arrivalItem").getAttribute("data-product");if(o)return document.location.href="item"+o+".html",o},Thumbnail.prototype.doFullImg=function(e){var t=e&&e.target||e.srcElement;t.parentNode.querySelector("img")&&(this.fullImg.src=t.parentNode.querySelector("img").src)},ProductOptions.prototype.addClassToOption=function(e){var t=e&&e.target||e.srcElement,o=t.parentNode;if("LI"==t.tagName){for(var r=0;r<o.children.length;r++)o.children[r].classList.remove("activeOption");t.classList.add("activeOption")}},Bag.prototype.addGoose=function(e){e.preventDefault();var t=0,o=0;if(document.querySelectorAll(".activeOption").length===document.querySelectorAll(".listOptions").length){document.querySelector(".chooseOptions").classList.remove("display"),document.querySelector(".addedGoose").classList.remove("display"),this.addCart(e);for(var r in this.cart)t++,o+=+this.cart[r].price.split("£")[1]*this.cart[r].qw;localStorage.countItems=t,localStorage.commonPrice=o,document.querySelector(".commonPrice").innerHTML="£ "+localStorage.commonPrice+'<span class="countItems"> ('+localStorage.countItems+")</span>",document.querySelector(".addedGoose").classList.add("display")}else document.querySelector(".chooseOptions").classList.add("display")},Bag.prototype.addCart=function(e){var t=document.querySelector(".nameProduct").innerText,o=document.querySelector(".priceItem").innerText,r=document.querySelector(".sizeOptions").querySelector(".activeOption").innerText,i=document.querySelector(".colorOptions").querySelector(".activeOption").innerText,s=document.querySelector(".nameProduct").getAttribute("data-nameProduct"),c=document.querySelector(".fullItem").querySelector("img").getAttribute("src"),l=s+"-"+i+" "+r;l=l.replace(/\s/g,"-"),this.cart[l]?this.cart[l].qw+=1:this.cart[l]={product:t,price:o,size:r,color:i,id:s,img:c,qw:1};var n=JSON.stringify(this.cart);localStorage.cart=n},Search.prototype.openSearch=function(){document.querySelector(".search").classList.toggle("openSearch"),document.querySelector(".searchForm").classList.toggle("display")},Menu.prototype.openMenu=function(e){e.preventDefault(),document.querySelector(".header").classList.toggle("openMenu"),this.nav.classList.toggle("display")},Shop.prototype.createItem=function(e,t){return'<div class="shoppingBlock clearfix" data-block="'+t+'"><div class="shopImg"><img src="'+e.img+'" alt=""><p class="priceBag">'+e.price+'</p></div><div class="shopOptions"><p class="titleProduct"><a href="item1.html" class="productBag">'+e.product+'</a></p><p class="optionBag">Color: <span class="colorBag">'+e.color+'</span></p><p class="optionBag">Size: <span class="sizeBag">'+e.size+'</span></p><p class="optionBag">Quantity: <span class="quantityBag">'+e.qw+'</span></p><p class="removeItem">Remove Item</p></div></div>'},Shop.prototype.buyGoose=function(e){e.preventDefault(),this.clearBag(),document.querySelector(".shopItems").innerHTML='<p class="thanks">Thank you for your purchase</p>',this.totalSum()},Shop.prototype.removeItem=function(e){var t=e&&e.target||e.srcElement,o=t.closest(".shoppingBlock"),r=o.getAttribute("data-block"),i=0,s=0;o.parentNode.removeChild(o),delete this.cart[r];var c=JSON.stringify(this.cart);localStorage.cart=c,this.cart=localStorage.cart?JSON.parse(localStorage.cart):{};for(var l in this.cart)s++,i+=+this.cart[l].price.split("£")[1]*this.cart[l].qw;localStorage.countItems=s,localStorage.commonPrice=i,document.querySelector(".commonPrice").innerHTML="£"+localStorage.commonPrice+'<span class="countItems">('+localStorage.countItems+")</span>",this.checkEmpty(),this.totalSum()},Shop.prototype.clearBag=function(e,t){t&&t.preventDefault(),localStorage.clear(),document.querySelector(".commonPrice").innerHTML="",""==e&&(this.emptyInfo(),this.totalSum())},Shop.prototype.emptyInfo=function(){document.querySelector(".shopItems").innerHTML='<p class="empty">Your shopping bag is empty. Use Catalog to add new items</p>'},Shop.prototype.checkEmpty=function(){"{}"!=localStorage.cart&&void 0!=localStorage.cart||this.emptyInfo()},Shop.prototype.totalSum=function(){this.totalCost.innerHTML=localStorage.commonPrice?"£ "+localStorage.commonPrice:"£ 0"},Slider.prototype.generatePoints=function(e){for(var t="",o=1;o<=e;o++)t+='<span data-controls="'+o+'"> </span>';this.controls.innerHTML="",this.controls.insertAdjacentHTML("afterBegin",t);this.controls.firstElementChild.classList.add("activeSlide")},Slider.prototype.moveSliderOnClick=function(e){var t=e&&e.target||e.srcElement;if(t&&(console.log(t),t.getAttribute("data-controls"))){var o=t.getAttribute("data-controls");this.currentSlide=o-1,this.moveSlides(t)}},Slider.prototype.autoSlider=function(e){this.slideInterval=setInterval(this.nextSlide.bind(this),e)},Slider.prototype.nextSlide=function(e){this.currentSlide=(this.currentSlide+1)%this.items.length,this.moveSlides(this.controls.children[this.currentSlide])},Slider.prototype.moveSlides=function(e){var t=document.querySelector(".sliderList"),o=document.querySelector(".activeSlide"),r=(document.querySelector(".slider").clientWidth,this.ul.firstElementChild.clientWidth*this.items.length);o.classList.remove("activeSlide"),e.classList.add("activeSlide"),console.log(r,this.sliderWidth),t.style.cssText="transform: translateX(-"+(this.sliderWidth-1)*this.currentSlide+"px); transition: 0.5s; width:"+r+"px"},Slider.prototype.clearInterval=function(){clearInterval(this.slideInterval)};